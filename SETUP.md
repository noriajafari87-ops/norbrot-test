# راهنمای نصب و راه‌اندازی بک‌اند

## پیش‌نیازها

قبل از شروع، مطمئن شوید که Node.js روی سیستم شما نصب است:

1. **Node.js** (نسخه 14 یا بالاتر) - از [nodejs.org](https://nodejs.org) دانلود کنید
2. **npm** (معمولاً با Node.js نصب می‌شود)

## مراحل نصب

### 1. نصب پکیج‌های مورد نیاز

در پوشه پروژه، دستور زیر را اجرا کنید:

```bash
npm install
```

این دستور تمام پکیج‌های مورد نیاز را نصب می‌کند:
- `express` - فریمورک وب سرور
- `sqlite3` - دیتابیس SQLite
- `bcryptjs` - رمزگذاری پسورد
- `express-session` - مدیریت session
- `cors` - مدیریت CORS
- `body-parser` - پردازش درخواست‌ها

### 2. راه‌اندازی سرور

برای شروع سرور، یکی از دستورات زیر را اجرا کنید:

**برای محیط توسعه:**
```bash
npm run dev
```

**برای محیط تولید:**
```bash
npm start
```

### 3. دسترسی به وب‌سایت

پس از راه‌اندازی سرور، به آدرس زیر بروید:
```
http://localhost:3000
```

## ویژگی‌های بک‌اند

### 🔐 سیستم احراز هویت
- **ثبت‌نام**: اطلاعات کاربر با استاندارد آلمانی ذخیره می‌شود
- **ورود**: احراز هویت با ایمیل و پسورد
- **Session Management**: مدیریت جلسات کاربری
- **خروج**: خروج امن از سیستم

### 👤 مدیریت کاربران
- **پروفایل کاربری**: نمایش اطلاعات شخصی و آدرس
- **تاریخچه سفارشات**: مشاهده تمام سفارشات قبلی
- **به‌روزرسانی اطلاعات**: امکان تغییر اطلاعات کاربری

### 🛒 سیستم سفارش
- **محافظت از checkout**: فقط کاربران لاگین شده می‌توانند سفارش دهند
- **ذخیره سفارشات**: تمام سفارشات در دیتابیس ذخیره می‌شوند
- **مدیریت وضعیت**: پیگیری وضعیت سفارشات

### 🗄️ دیتابیس SQLite
- **جدول users**: اطلاعات کاربران
- **جدول orders**: اطلاعات سفارشات
- **رابطه‌های دیتابیس**: ارتباط بین کاربران و سفارشات

## API Endpoints

### احراز هویت
- `POST /api/register` - ثبت‌نام کاربر جدید
- `POST /api/login` - ورود کاربر
- `POST /api/logout` - خروج کاربر
- `GET /api/auth/status` - بررسی وضعیت احراز هویت

### مدیریت کاربر
- `GET /api/user` - دریافت اطلاعات کاربر فعلی

### مدیریت سفارش
- `POST /api/orders` - ایجاد سفارش جدید
- `GET /api/orders` - دریافت سفارشات کاربر

## ساختار فایل‌ها

```
├── server.js          # سرور اصلی Express
├── package.json       # تنظیمات پروژه و dependencies
├── bakery.db          # دیتابیس SQLite (خودکار ایجاد می‌شود)
├── index.html         # صفحه اصلی
├── login.html         # صفحه ورود
├── register.html      # صفحه ثبت‌نام
├── profile.html       # صفحه پروفایل کاربر
├── products.html      # صفحه محصولات
├── checkout.html      # صفحه تسویه حساب
├── about.html         # صفحه درباره ما
├── styles.css         # استایل‌های CSS
├── script.js          # JavaScript فرانت‌اند
└── SETUP.md           # این فایل راهنما
```

## نکات مهم

### 🔒 امنیت
- پسوردها با bcrypt رمزگذاری می‌شوند
- Session ها با secret key محافظت می‌شوند
- تمام درخواست‌ها اعتبارسنجی می‌شوند

### 🌐 CORS
- تنظیمات CORS برای توسعه محلی فعال است
- برای تولید، تنظیمات CORS باید به‌روزرسانی شود

### 📱 Responsive
- تمام صفحات responsive هستند
- منوی موبایل با hamburger menu

## عیب‌یابی

### مشکل: سرور شروع نمی‌شود
**راه‌حل**: مطمئن شوید Node.js نصب است و پکیج‌ها نصب شده‌اند:
```bash
node --version
npm --version
npm install
```

### مشکل: دیتابیس ایجاد نمی‌شود
**راه‌حل**: مطمئن شوید پوشه پروژه قابل نوشتن است و SQLite3 نصب است.

### مشکل: CORS Error
**راه‌حل**: مطمئن شوید سرور روی پورت 3000 در حال اجرا است.

## پشتیبانی

اگر مشکلی داشتید:
1. لاگ‌های کنسول را بررسی کنید
2. مطمئن شوید تمام پکیج‌ها نصب شده‌اند
3. پورت 3000 آزاد است

---

**موفق باشید! 🥖✨**
